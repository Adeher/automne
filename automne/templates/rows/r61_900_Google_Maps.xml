<row>
	<block module="standard" type="varchar" id="titre">
		<?php 
		$frontend = (strpos($_SERVER["SCRIPT_NAME"], 'automne/admin') === false) ? true : false;
		/////////////////////////////////////////////////
		//              Googlemaps settings            //
		/////////////////////////////////////////////////
		// To qualify for service Googlemaps you have to got a valid Google key on the following website :
		// http://code.google.com/apis/maps/signup.html
		// Then you have to copy this key in the config.php file (located at the root of your website) add the following line :
		// define("GOOGLE_MAPS_KEY", "INSERT_GOOGLE_KEY_HERE");
		// And insert your key between the quotes.
		
		// Height (value expressed in pixels) :
		$mapHeight = 400;
		// Width (value expressed in pixels) :
		$mapWidth = 400;
		// Zoom value :
		$zoom = 12;
		// View type (SATELLITE/NORMAL/HYBRID) :
		$vue = "HYBRID";

		$address = <<<END
		{{data}}
END;
		if (defined('GOOGLE_MAPS_KEY') && GOOGLE_MAPS_KEY) {
			$mapId = 'map-'.md5(rand());
			echo '
			<script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key='.GOOGLE_MAPS_KEY.'" type="text/javascript"></script>
			<p id="'.$mapId.'" style="width:'.$mapWidth.'px; height:'.$mapHeight.'px"></p>
		    <script type="text/javascript">
		    (function(){
				var map = new GMap2(document.getElementById("'.$mapId.'"));
				map.addControl(new GSmallMapControl());
			    var geocoder = new GClientGeocoder();
				geocoder.getLatLng(
					\''.sensitiveIO::sanitizeJSString($address,"'").'\',
					function(point) {
						if (point) {
							map.setCenter(point, '.$zoom.');
							map.setMapType(G_'.$vue.'_MAP);
							var marker = new GMarker(point);
							map.addOverlay(marker);
							GEvent.addListener(marker, "click", function() {
								marker.openInfoWindowHtml(\'<div style="width: 210px; padding-right: 10px">'.sensitiveIO::sanitizeJSString($address,"'").'<\/div>\');
							});
						}
					}
				);
			})();
			</script>
		';
		} elseif(!$frontend) {
			switch($cms_language->getCode()){
				case 'en':
					echo "
					<p>
						To qualify for service Googlemaps you have to got a valid Google key on
						<a href='http://code.google.com/apis/maps/signup.html'>the following website</a>.
						<br/>Then you have to copy this key in the config.php file (located at the root of your website) add the following line :
						<pre>define(\"GOOGLE_MAPS_KEY\", \"INSERT_GOOGLE_KEY_HERE\");</pre>
						And insert your key between the quotes.
					</p>";
				break;
				default:
					echo "
					<p>
						Pour utiliser le service Googlemaps vous devez récupérer une clé Google valide sur <a href='http://code.google.com/apis/maps/signup.html'>ce site</a>.
						<br/>Ensuite, écrivez la ligne ci-dessous dans le fichier config.php (situé à la racine de votre site) :
						<pre>define(\"GOOGLE_MAPS_KEY\", \"INSERT_GOOGLE_KEY_HERE\");</pre>
						Insérez votre clé entre les apostrophes.
					</p>";
				break;
			}
		}
		?>
	</block>
</row>