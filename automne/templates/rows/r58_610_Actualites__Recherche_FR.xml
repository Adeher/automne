<row>
	<block module="pnews" id="newssearch">
		<div class="pnews">
			<script type="text/javascript">
				var pageURL = '{page:self:url}';
			</script>
			<form action="{page:self:url}" method="get" class="pnews-form">
				<label for="pnews-keyword">Mots Cl&eacute;s : </label><input type="text" class="input-text pnews-keyword search" id="pnews-keyword" name="keyword" value="{request:string:keyword}" />
				<input type="submit" class="button pnews-submit" name="submit" value="ok" />
				<img class="pnews-loading hide" src="img/demo/common/loading.gif" alt="Chargement ..." />
			</form>
		</div>
		<div class="pnews">
			<atm-xml what="{request:string:out} == 'xml'">
				<atm-search what="{['object1']}" name="newsresult">
					<atm-search-param search="newsresult" type="keywords" value="{request:string:keyword}" mandatory="false" />
					<atm-search-param search="newsresult" type="item" value="{request:int:item}" mandatory="false" />
					<atm-search-limit search="newsresult" value="10" />
					<atm-search-page search="newsresult" value="{request:int:page}" />
					<atm-search-order search="newsresult" type="publication date start" direction="desc" />
					<atm-result search="newsresult">
						<atm-if what="{firstresult}">
							<atm-start-tag tag="div" class="pnews-results" />
						</atm-if>
						<atm-if what="{firstresult} &amp;&amp; !{request:int:item}">
							<div class="pnews-results-count">{maxresults} r&eacute;sultat(s) pour votre recherche.</div>
						</atm-if>
						<div class="pnews-result">
							<h2><a href="{page:self:url}?item={['object1']['id']}" title="{['object1']['label']}">{['object1']['label']}</a></h2>
							<p class="date">{['object1']['formatedDateStart']|d/m/Y}</p>
							<atm-if what="{['object1']['fields'][4]['imageName']}">
								<div class="right">
									<atm-if what="{['object1']['fields'][4]['imageZoomName']}" name="thumbnail">
										<a href="{['object1']['fields'][4]['imageZoom']|800}" target="_blank" title="Illustration '{['object1']['label']}' ({['object1']['fields'][4]['fileExtension']} - {['object1']['fields'][4]['fileSize']}Mo)" rel="atm-enlarge"><img src="{['object1']['fields'][4]['image']|100}" alt="{['object1']['label']}" /></a>
									</atm-if>
									<atm-else for="thumbnail">
										<img src="{['object1']['fields'][4]['image']|100}" alt="{['object1']['label']}" />
									</atm-else>
								</div>
							</atm-if>
							<atm-if what="{request:int:item} == {['object1']['id']}">
								{['object1']['fields'][2]['htmlvalue']}
								{['object1']['fields'][3]['htmlvalue']}
								<p><a href="{page:self:url}">Retour aux actualités</a></p>
							</atm-if>
							<atm-if what="!{request:int:item}">
								{['object1']['fields'][2]['htmlvalue']}
								<a href="{page:self:url}?item={['object1']['id']}" title="Lire la suite de l'actualité '{['object1']['label']}'">
									Lire la suite ...
								</a>
							</atm-if>
							<div class="clear"></div>
						</div>
						<atm-if what="{resultcount}>10 &amp;&amp; {lastresult} &amp;&amp; !{request:int:item}">
							<div class="pnews-pages">
								<atm-function function="pages" maxpages="{maxpages}" currentpage="{currentpage}" displayedpage="5">
									<pages><a href="{page:self:url}?keyword={request:string:keyword}&amp;page={n}">{n}</a> </pages>
									<currentpage><strong>{n}</strong> </currentpage>
									<previous><a href="{page:self:url}?keyword={request:string:keyword}&amp;page={n}">Page pr&eacute;c&eacute;dente</a> </previous>
									<next><a href="{page:self:url}?keyword={request:string:keyword}&amp;page={n}">Page suivante</a> </next>
								</atm-function> 
							</div>
						</atm-if>
						<atm-if what="{lastresult}">
							<atm-end-tag tag="div" />
						</atm-if>
					</atm-result>
					<atm-noresult search="newsresult">Aucun r&eacute;sultat trouv&eacute; pour votre recherche ...</atm-noresult>
				</atm-search>
			</atm-xml>
		</div>
	</block>	
</row>